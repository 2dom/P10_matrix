
#include <Ticker.h>
#include <P10_matrix.h>

Ticker display_ticker;


// Pins for LED MATRIX
#define P_LAT 16
#define P_A 5
#define P_B 4
#define P_C 15
#define P_OE 2
P10_MATRIX display( P_LAT, P_OE,P_A,P_B,P_C);

// Some standard colors
uint16_t myRED = display.color565(255, 0, 0);
uint16_t myGREEN = display.color565(0, 255, 0);
uint16_t myBLUE = display.color565(0, 0, 255);
uint16_t myWHITE = display.color565(255, 255, 255);
uint16_t myYELLOW = display.color565(255, 255, 0);
uint16_t myCYAN = display.color565(0, 255, 255);
uint16_t myMAGENTA = display.color565(255, 0, 255);
uint16_t myBLACK = display.color565(0, 0, 0);

uint16 myCOLORS[8]={myRED,myGREEN,myBLUE,myWHITE,myYELLOW,myCYAN,myMAGENTA,myBLACK};

uint8_t weather_icons[]={0x00,0x01,0x08,0x00,0x00,0x21,0x08,0x00,0x00,0x20,0x00,0x00,0x00,0x22,0x00,0x20,0x00,0x02,0x00,0x40,0x00,0x00,0x08,0x42,0x08,0x20,0x00,0x01,0xff,0xc0,0x00,0x41,0x00,0x00,0xff,0xa1,0x08,0x40,0x00,0x01,0x00,0x20,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x20,0x08,0x20,0x00,0x01,0x08,0x00,0x00,0x60,0x00,0x00,0x08,0x00,0x00,0x44,0x00,0x21,0x08,0x00,0x00,0x20,0x00,0x20,0x00,0x20,0x08,0x01,0x00,0x41,0x08,0x00,0x00,0x41,0x08,0x00,0x00,0x60,0x07,0xdf,0x07,0xdf,0x07,0xff,0x00,0x00,0x10,0x00,0x00,0x20,0x00,0x40,0x00,0x00,0x00,0x01,0x00,0x61,0x07,0x9e,0x07,0xff,0x07,0xff,0x08,0x00,0x00,0x00,0x08,0x00,0x08,0x60,0x08,0x01,0x00,0x80,0x08,0x02,0x00,0x00,0x00,0x00,0xff,0xe0,0xff,0xc0,0xff,0xe0,0xef,0xe0,0x00,0x20,0x08,0x20,0x00,0x21,0x00,0x20,0x00,0x20,0x07,0xfe,0x08,0x00,0x00,0x00,0x08,0x61,0x00,0x00,0x00,0x00,0x00,0x20,0x08,0x00,0x00,0x00,0x00,0x40,0x08,0x00,0x00,0x00,0x10,0x00,0x00,0x21,0x00,0x61,0x10,0x00,0x00,0x01,0x00,0x60,0xff,0xc1,0xff,0xe0,0xff,0xc0,0xff,0xe1,0xff,0xe0,0x00,0x20,0x00,0x20,0x00,0x00,0x00,0x02,0x08,0x00,0xff,0xe0,0xf7,0xe0,0xff,0xe1,0xff,0x80,0xf7,0xe0,0x00,0x21,0x08,0x20,0x00,0x01
,0x08,0x00,0x00,0x40,0x00,0x00,0x00,0x01,0xff,0xe0,0x00,0x03,0x00,0x00,0x00,0x40,0x08,0x42,0x08,0x00,0x00,0x41,0x00,0x20,0x00,0x40,0x10,0x23,0x08,0x00,0x00,0x20,0x00,0x60,0x00,0x22,0x00,0x01,0x00,0x60,0x08,0x00,0x00,0x00,0x00,0x20,0x07,0xfe,0x07,0xff,0x00,0x00,0x08,0x00,0x00,0x22,0x00,0x00,0x00,0x02,0x00,0x20,0x10,0x00,0x07,0xbf,0x07,0xff,0x0f,0xbd,0x00,0x04,0x00,0x20,0x00,0x00,0x08,0x20,0x00,0x02,0x00,0x00,0x08,0x03,0x07,0xdf,0x1f,0x9c,0x07,0xfe,0x07,0x9f,0x07,0xff,0x07,0xfe,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x20,0x07,0xff,0x07,0xfe,0x07,0xdf,0x07,0xdd,0x0f,0xff,0x07,0xdf,0x00,0x00,0x00,0x00,0x00,0x21,0x00,0x20,0x00,0x00,0x08,0x20,0xff,0xe0,0xff,0xe0,0xff,0xe1,0xff,0xc0,0x00,0x22,0x10,0x03,0x00,0x20,0x08,0x00,0x00,0x02,0x07,0xff,0x07,0x9e,0x07,0xff,0x00,0x42,0x00,0x00,0x00,0x21,0x08,0x21,0x07,0xdf,0x00,0x21,0x00,0x21,0x07,0xff,0x07,0x9f,0x07,0xff,0x00,0x00,0x08,0x00,0x07,0xfe,0x08,0x20,0x00,0x22,0xef,0xe0,0xff,0xa0,0xf7,0xe0,0xff,0xe0,0xff,0xa0,0xff,0xe0,0xff,0xa0,0x00,0x01,0x08,0x20,0x00,0x60,0xff,0xc0,0xff,0xe1,0xff,0xe1,0xff,0xe0,0xff,0xe0,0xff,0xe1,0xef,0xe0,0x00,0x00,0x08,0x60
,0x00,0x01,0x00,0x00,0xf7,0xc0,0x00,0x20,0x00,0x00,0x08,0x21,0xff,0xe1,0x00,0x00,0x00,0x20,0x00,0x00,0x08,0x20,0x08,0x01,0xff,0xe0,0x00,0x00,0xff,0xe0,0xff,0xc0,0xff,0xe0,0x00,0x00,0x08,0x20,0x00,0x41,0x08,0x00,0x00,0x00,0x0f,0x5f,0x07,0xff,0x07,0xbf,0x0f,0xfd,0x07,0xff,0x00,0x20,0x00,0x00,0x00,0x01,0x00,0x20,0x0f,0xbe,0x07,0xfe,0x07,0xfe,0x07,0xbf,0x07,0xdf,0x07,0xfd,0x00,0x40,0x00,0x21,0x08,0x00,0x08,0x00,0x07,0xff,0x07,0xdf,0x07,0x9f,0x0f,0xfe,0x0f,0xff,0x07,0xdf,0x07,0xde,0x07,0xfd,0x00,0x00,0x10,0x20,0x07,0xbd,0x07,0xbf,0x0f,0xdc,0x0f,0xfe,0x07,0xbf,0x07,0xbf,0x07,0xdf,0x07,0xff,0x00,0x21,0x10,0x20,0x00,0x01,0x00,0x20,0xf7,0xe0,0xf7,0xe0,0xf7,0xe1,0xff,0xa0,0x08,0x00,0x00,0x60,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x01,0x00,0x60,0x0f,0xfe,0x00,0x40,0x08,0x01,0x08,0x21,0x00,0x20,0x00,0x20,0x00,0x00,0x07,0xff,0x07,0xdf,0x00,0x00,0x08,0x81,0x00,0x00,0x07,0x9f,0x07,0xff,0x00,0x00,0x00,0x41,0xff,0xe0,0xff,0xc0,0xff,0xe2,0xff,0xc0,0xf7,0xe0,0xff,0xe0,0xff,0xe1,0xff,0xa1,0xff,0xe0,0x00,0x00,0xf7,0xa0,0xff,0xe2,0xff,0xe0,0xf7,0xc0,0xf7,0xe0,0xff,0xe0,0xf7,0xc1,0xff,0xe0,0xff,0xe0,0x00,0x00
,0x08,0x20,0x00,0x01,0x00,0x20,0xff,0xe2,0xff,0xe2,0xf7,0x80,0x08,0x03,0x00,0x20,0x08,0x00,0x00,0x21,0x08,0x02,0x00,0x20,0x07,0xff,0x07,0xfe,0x07,0xff,0xf7,0xe0,0xff,0x80,0xf7,0xe0,0x00,0x40,0xff,0xc0,0x00,0x00,0x07,0xff,0x07,0xff,0x07,0xbd,0x07,0xfe,0x0f,0xff,0x07,0xbf,0x07,0xff,0x00,0x20,0x08,0x00,0x07,0xbf,0x07,0xfd,0x07,0xff,0x07,0xff,0x07,0xfe,0x17,0xbf,0x07,0xdf,0x07,0xbf,0x00,0x20,0x00,0x61,0x07,0xfe,0x07,0xbe,0x0f,0xff,0x07,0xfe,0x07,0xbe,0x07,0xbd,0x0f,0xdf,0x07,0xff,0x07,0xff,0x00,0x43,0x07,0xdc,0x07,0xdf,0x07,0xff,0x07,0xdf,0x07,0xbf,0x07,0xff,0x07,0xdd,0x07,0xdf,0x07,0xdf,0x08,0x00,0x00,0x02,0x00,0x00,0xff,0xe1,0xff,0xe3,0xff,0xe0,0xff,0xe0,0x00,0x03,0x00,0x01,0x10,0x40,0x00,0x00,0x10,0x02,0x07,0xfe,0x00,0x20,0x0f,0xdf,0x07,0xdf,0x07,0xbf,0x10,0x00,0x07,0xff,0x08,0x00,0x00,0x20,0x10,0x01,0x00,0x20,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x41,0x00,0x00,0x00,0x21,0x00,0x60,0x00,0x00,0xff,0xa0,0xff,0xe0,0xff,0xc0,0xff,0xc0,0xff,0xe1,0xf7,0xc0,0xf7,0xe0,0xf7,0xe0,0xff,0xa0,0x00,0x00,0xff,0xe0,0xff,0xe0,0xf7,0xe0,0xff,0xe0,0x07,0xde,0x07,0xff,0x0f,0xbf,0xff,0xe1,0xff,0xa0,0x00,0x21
,0x00,0x20,0xff,0xc0,0x00,0x00,0xff,0xc2,0xf7,0xe0,0xff,0xe0,0x00,0x40,0xff,0xe0,0x00,0x40,0x00,0x83,0x08,0x01,0x07,0xfd,0x07,0xbf,0x07,0x7f,0x0f,0x9e,0x07,0xff,0x07,0xff,0xff,0xe0,0x08,0x02,0x00,0x01,0x07,0xbf,0x0f,0xbf,0x07,0xbf,0x07,0xff,0x07,0xdd,0x07,0x9f,0x07,0xff,0x07,0xbb,0x07,0xff,0x08,0x40,0x07,0xdf,0x07,0xfe,0x07,0x9f,0x07,0xdf,0x17,0xff,0x07,0xdd,0x07,0xff,0x07,0xff,0x07,0xff,0x08,0x00,0x08,0x00,0x07,0xff,0x07,0xff,0x07,0xdf,0x00,0x00,0x00,0x40,0x00,0x00,0x10,0x20,0x00,0x00,0x00,0x01,0x00,0x41,0x07,0xfc,0x07,0xfd,0x07,0xdf,0x00,0x41,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x20,0x00,0x20,0x10,0x00,0xff,0xe0,0xef,0xe0,0xf7,0xc0,0xff,0xc0,0xf7,0xe1,0xff,0xa0,0xff,0xe0,0x00,0x20,0x00,0x20,0x0f,0xdf,0x07,0xdf,0x07,0xff,0x07,0xbe,0xff,0xff,0x0f,0xff,0x07,0xbf,0x07,0xdf,0x0f,0xfd,0x00,0x00,0x07,0xdf,0x00,0x40,0x00,0x00,0x0f,0xff,0x07,0xff,0x07,0xdf,0x08,0x40,0x00,0x00,0x07,0xbe,0x08,0x02,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xff,0xc0,0xff,0xe0,0x00,0x01,0xff,0xe0,0xf7,0xe0,0xff,0xe2,0x07,0xff,0x17,0x9f,0x07,0xdf,0x07,0xff,0x07,0xde,0x07,0xfd,0x00,0x61
,0x08,0x00,0x08,0x23,0x08,0x01,0xf7,0x80,0xff,0xe0,0xff,0xe1,0x08,0x00,0x00,0x41,0x00,0x00,0x00,0x00,0x0f,0xff,0x07,0xdf,0x0f,0xfd,0x07,0xff,0x0f,0xff,0x07,0xde,0x07,0xbe,0x07,0xff,0x00,0x20,0x00,0x40,0x07,0xfe,0x07,0xdf,0x07,0xbe,0x07,0xde,0x07,0xdf,0x07,0xff,0x07,0x9f,0x07,0xdd,0x07,0xff,0x10,0x00,0x00,0x22,0x0f,0xdf,0x07,0xff,0x07,0xff,0x07,0x9e,0x07,0xff,0x07,0x7f,0x07,0xff,0x00,0x20,0x08,0x01,0x00,0x00,0x00,0x20,0x0f,0xff,0x00,0x00,0xff,0xff,0x00,0x41,0xff,0xff,0x00,0x01,0x00,0x20,0x00,0x40,0x00,0x00,0x00,0x02,0x07,0xff,0x00,0x41,0xff,0xde,0x08,0x00,0xff,0xff,0x00,0x00,0x08,0x21,0x00,0x41,0x00,0x21,0x08,0x00,0x00,0x00,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xff,0xe1,0x00,0x20,0x00,0x60,0x08,0x02,0x00,0x00,0x07,0xfe,0x00,0x01,0x0f,0xdd,0x07,0xff,0x07,0x9f,0x08,0x21,0x0f,0xde,0x00,0x20,0x08,0x01,0x00,0x00,0x07,0xff,0x07,0xfe,0x00,0x00,0x00,0x01,0x00,0x40,0x0f,0x9e,0x0f,0xfe,0x00,0x40,0x08,0x62,0xf7,0xc0,0xff,0xc0,0xff,0xe0,0xff,0x80,0xff,0xc0,0xff,0xe0,0xff,0xc0,0xff,0xe0,0xf7,0xa1,0x00,0x60,0xff,0xc0,0xff,0xe0,0x0f,0x9f,0x0f,0xbf,0x07,0xff,0x07,0xdd,0x07,0xdf,0x07,0xdf,0x07,0xfd,0x08,0x00
,0x00,0x22,0x00,0x00,0xff,0xe1,0x08,0x03,0x00,0x20,0x08,0x00,0xff,0xe0,0x00,0x20,0x00,0x00,0x00,0x42,0x07,0xff,0x07,0xde,0x07,0xdf,0x07,0xdf,0x07,0xdd,0x0f,0xbf,0x17,0xdf,0x00,0x01,0x00,0x22,0xff,0xe0,0x07,0xbf,0x0f,0xde,0x07,0xdf,0x07,0xff,0x07,0xdf,0x07,0xbe,0x07,0xff,0x0f,0xff,0x07,0xff,0x00,0x00,0x00,0x20,0x08,0x20,0x07,0x9f,0x17,0xde,0x07,0xfe,0x07,0xbf,0x0f,0xfe,0x08,0x41,0x00,0x00,0x00,0x61,0x10,0x40,0x00,0x40,0x00,0x02,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x20,0x08,0x20,0x00,0x00,0x00,0x21,0x00,0x00,0x08,0x20,0x18,0x00,0xf7,0xdf,0x00,0x20,0xff,0xdf,0x00,0x20,0x08,0x20,0x00,0x00,0xef,0xe2,0x10,0x00,0xff,0xc1,0xff,0xa0,0xef,0xe0,0xff,0xa0,0x00,0x00,0x08,0x43,0x08,0x00,0x00,0x01,0x08,0x61,0x10,0x01,0x08,0x40,0x00,0x00,0x07,0xff,0x00,0x00,0x00,0x41,0x00,0x00,0x00,0x40,0x00,0x01,0x00,0x21,0x00,0x00,0x10,0x00,0x00,0x20,0x08,0x41,0x10,0x40,0x00,0x02,0x00,0x20,0x10,0x02,0x00,0x00,0xff,0xe0,0xff,0xe2,0xff,0xc0,0xff,0xe0,0xff,0xe0,0xff,0xc0,0xff,0xc1,0xff,0xe0,0xff,0xc0,0x00,0x02,0xff,0xa0,0xff,0xe0,0x07,0x9d,0x07,0xff,0x07,0xbf,0x07,0xfe,0x07,0xff,0x07,0xff,0x07,0xff,0x08,0x00
,0x00,0x00,0x00,0x20,0x00,0x40,0x00,0x00,0xff,0xe0,0x00,0x20,0x00,0x20,0x08,0x00,0x08,0x00,0x00,0x00,0x00,0x21,0x07,0xfe,0x07,0xbe,0x0f,0xbf,0x07,0xfe,0x07,0xfe,0x00,0x00,0x00,0x61,0x10,0x00,0x08,0x21,0x00,0x20,0x07,0xff,0x07,0xff,0x07,0xbf,0x07,0xff,0x07,0xdf,0x0f,0xff,0x07,0xbe,0x10,0x00,0x00,0x22,0x00,0x20,0x00,0x00,0x08,0x20,0x00,0x01,0x00,0x02,0x08,0x00,0x00,0x20,0x00,0x00,0x10,0x20,0x00,0x20,0x00,0x01,0x00,0x01,0x08,0x20,0x00,0x00,0x00,0x01,0xf7,0xfe,0x08,0x03,0xf7,0xff,0x00,0x01,0x08,0x20,0x00,0x41,0x00,0x01,0x00,0x40,0x00,0x21,0x00,0x20,0xff,0xdf,0x00,0x00,0xf7,0xff,0x00,0x00,0x08,0x00,0xff,0xe0,0xf7,0xe0,0xf7,0xc0,0xf7,0xe0,0xff,0xe1,0x00,0x20,0x08,0x41,0x00,0x00,0x00,0x20,0x00,0x40,0x00,0x20,0x00,0x21,0x00,0x01,0x07,0xdf,0x07,0xdd,0x07,0xff,0x00,0x00,0x08,0x20,0x00,0x00,0x00,0x40,0x07,0xdf,0x00,0x02,0x00,0x00,0x07,0xfe,0x07,0xbf,0x0f,0xde,0x00,0x00,0x00,0x22,0x07,0xfe,0x00,0x20,0x08,0x20,0xf7,0xe0,0xff,0xa1,0xef,0xe1,0xff,0xc0,0xff,0xe0,0xf7,0xe0,0xf7,0xe0,0x10,0x00,0x10,0x01,0x00,0xa0,0xff,0x61,0xff,0xe0,0x07,0xde,0x07,0xdf,0x07,0xff,0x0f,0xbe,0x07,0xfd,0x08,0x01,0x00,0x40
,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x08,0x40,0x00,0x01,0x07,0xdd,0x07,0xdf,0x07,0xfd,0x08,0x02,0x10,0x00,0x00,0x20,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x03,0x07,0xfd,0x07,0xdf,0x07,0xbf,0x17,0xbe,0x07,0xfc,0x08,0x04,0x00,0x01,0x08,0x00,0x00,0x80,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x20,0x00,0x00,0xff,0xff,0x00,0x00,0xff,0xff,0x00,0x20,0x00,0x20,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xff,0xe0,0x10,0x00,0x00,0x40,0x00,0x00,0x00,0x02,0x00,0x40,0x00,0x22,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x42,0x0f,0xf8,0x08,0x02,0x00,0x20,0x00,0x20,0x00,0x00,0x00,0x01,0x00,0x20,0x07,0xff,0x07,0xbf,0x00,0x02,0x00,0x40,0x08,0x02,0x07,0xff,0x0f,0x9e,0x00,0x00,0x08,0x20,0x08,0x20,0x08,0x01,0xf7,0xe0,0xf7,0xe1,0xf7,0xe0,0xff,0xe0,0xf7,0xe1,0x08,0x01,0x08,0x20,0x00,0x01,0x00,0x01,0x08,0x01,0xf7,0xe1,0xf7,0xe0,0x07,0xbf,0x17,0xbe,0x07,0xfc,0x08,0x04,0x00,0x01,0x08,0x00
,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x00,0x20,0x00,0x01,0x00,0x21,0x00,0x21,0x08,0x00,0x00,0x40,0x00,0x40,0x00,0x41,0x00,0x01,0x00,0x21,0x00,0x20,0x00,0x20,0x10,0x00,0x00,0x81,0x08,0x02,0x08,0x01,0x08,0x01,0x00,0x60,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x61,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0xff,0xc0,0xff,0xe0,0xff,0xe0,0xff,0xe0,0xf7,0xe0,0x08,0x80,0x00,0x23,0x00,0x01,0x00,0x20,0x00,0x22,0x00,0x00,0x00,0x21,0x08,0x40,0x00,0x00,0x10,0x02,0x00,0x63,0x00,0x00,0x00,0x20,0x08,0x20,0x10,0x00,0x08,0x00,0x00,0x40,0x08,0x00,0x08,0x00,0x00,0x40,0x00,0x21,0x00,0x21,0x00,0x20,0x00,0x40,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x20,0x08,0x02,0x08,0x00,0x08,0x00,0x08,0x00,0x08,0x20,0x00,0x00,0x00,0x00,0x08,0x60,0x00,0x01,0x08,0x00,0x08,0x00,0x08,0x01,0x08,0x01,0x00,0x60,0x00,0x00,0x00,0x40,0x00,0x00
};




// ISR for display refresh
void display_updater()
{
  display.display(70);
}
void setup() {
  // put your setup code here, to run once:

  display.begin();
  display.clearDisplay();
  display.setTextColor(myCYAN);
  display.setCursor(2,0);
  display.print("Pixel");
  display.setTextColor(myMAGENTA);
  display.setCursor(2,8);
  display.print("Time");
  
  Serial.begin(9600);
  display_ticker.attach(0.001, display_updater);
  yield();
  delay(3000);
  display.clearDisplay();
}
union single_double{
  uint8_t two[2];
  uint16_t one;
} this_single_double;

// This draws the weather icons 
void draw_weather_icon (uint8_t icon)
{
  if (icon>10)
  icon=10;
  for (int yy=0; yy<10;yy++)
  {
    for (int xx=0; xx<10;xx++)
    {
      uint16_t byte_pos=(xx+icon*10)*2+yy*220;
      this_single_double.two[1]=weather_icons[byte_pos];
      this_single_double.two[0]=weather_icons[byte_pos+1];
      display.drawPixel(1+xx,yy,this_single_double.one);
    }
  }
}


uint8_t icon_index=0;
void loop() {

  display.clearDisplay();
  draw_weather_icon(icon_index);   
  icon_index++;
  if (icon_index>10)
    icon_index=0; 
  delay(3000);
}
